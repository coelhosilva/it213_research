---
title: Comparação de modelos para a estimativa de volume de passageiros com base na matriz origem-destino da telefonia móvel

# to produce blinded version set to 1
blinded: 0

authors:
- name: Fernando Antônio Pavão
  affiliation: Instituto Tecnológico de Aeronáutica
- name: Lucas Coelho e Silva
  affiliation: Instituto Tecnológico de Aeronáutica

keywords:
# 3 to 6 keywords, that do not appear in the title
- Modelo gravitacional
- Machine Learning
- Rede neural
- Regressão linear múltipla

abstract: |
  The text of your abstract.  200 or fewer words.

header-includes:
- \setlength{\parindent}{1.5cm}
- \usepackage{setspace}\doublespacing
- \usepackage[brazilian]{babel}
- \usepackage{csquotes}
- \usepackage{float}
- \usepackage{xcolor}
- \floatplacement{figure}{H}
bibliography: refs.bib
output: rticles::asa_article
---

```{r setup , include=FALSE}

# setwd("~/Dropbox/InovaAC/O1-E7-IMPACTO/Paper TRB")

library(cowplot)
library(data.table)
library(dplyr)
library(ggplot2)
library(stringr)
library(scales)
# library(ggridges)
library(viridis)
# library(ggthemes)

```

```{r function , include=FALSE}

# source(file = "Functions/getChartsCarga_distSum.R")
# source(file = "Functions/getChartsPax_distMean.R")
# source(file = "Functions/getChartsPax_distSum.R")
# 
# charts_carga_distSum <- getChartsCarga_distSum()
# charts_pax_distMean  <- getChartsPax_distMean()
# charts_pax_distSum   <- getChartsPax_distSum()

```


# Introdução
<!-- 
Perguntas a serem respondidas aqui: 
  - Explicar sobre o problema, qual é o objetivo de se debruçar sobre esse problema e quais são as abordagens para a solução. Breve introdução aos modelos. 
  - Por que fazer previsão de demanda? 
  - Por que utilizar diferentes modelos? (TODO: Grosche)
  - Quais dados vamos utilizar, de maneira geral?
-->

A previsão de demanda de passageiros é um objeto de pesquisa multidisciplinar cujos resultados podem auxiliar vários participantes do mercado de transporte aéreo.

Do ponto de vista das linhas aéreas, a previsão de demanda de passageiros pode ser utilizada para auxiliar na definição de novas rotas. Para administradores de aeroportos, os resultados têm aplicabilidade  quanto à estimativa dos requisitos de infraestrutura, por exemplo.

Existem diversas metodologias para estimar o volume de passageiros em dado período de tempo. Na prática, é comum que a parte interessada compare a previsão feita por mais de um modelo ao traduzir as estimativas para uma decisão de negócio [@Grosche2007]. Dessa forma, justifica-se um estudo que compare diferentes modelos para a previsão de demanda.

Neste estudo, três modelos foram construídos e avaliados: o modelo gravitacional, pioneiro e amplamente utilizado, e modelos de aprendizagem de máquina, um de redes neurais, e o outro com a utilização de regressão linear múltipla.

Os modelos foram construídos tendo como variáveis independentes dados geoeconômicos, disponibilizados pelo @atlasIpea. O volume real de passageiros utilizado é o disponível na matriz origem-destino construída a partir dos dados de telefonia móvel, disponibilizados na base de dados Hórus.


# Modelos de previsão de demanda

## Modelo gravitacional
<!-- Passo a passo da construção do modelo: -->
<!-- * Consolidação dos dados (par-cidade, variáveis independentes, volume medido) -->
<!-- * Criar uma função que com base nos dados de entrada (train and test) encontre os parâmetros do modelo, avalie a hipótese nula e quantifique o erro. -->
<!-- * Separação das observações no conjunto de calibração (análogo do *train set*) e conjunto de validação (estimation samples). Avaliação da hipótese nula e dos erros pela métrica escolhida pela função definida.  -->
<!-- * Testes de estabilidade estrutural dos coeficientes. O coeficiente varia de acordo com o conjunto escolhido? Quanto? -->

<!-- Importante: "modelos gravitacionais deveriam - *as in should* - ser aplicados em conjuntos de dados homogêneos, se possível" -->
<!-- Há maneiras diferentes de considerar. Ele pode ser direcionado ou não direcionado. A distinção também pode ser feita por parâmetros diferentes para production ou attraction ou apenas com diferentes valores de parâmetros. -->

<!-- Discussão sobre um modelo irrestrito, mas com a ressalva de que os dados de demanda medidos são influenciados pela capacidade de aeronaves e das rotas oferecidas hoje. -->

<!-- Por que utilizar apenas variáveis geo-econômicas? Possibilita a estimatvia em novos mercados. Ao utilizar por variáveis selecionadas a serviço, ficamos à mercê de coisas que estão sempre mudando por causa do mercaado volátil com muitas mudanças devido a competição, preços de combustíveis, modelo de negocios etc. -->

<!-- Grosche segregou rotas típicas de turismo dado que dependem de fatores diferentes das rotas com quantidade significatne de tráfego orientado a negócios. Seria o caso de fazer uma análise de clusterização das rotas?  -->
<!-- É um modelo causal, um dos pioneiros -->
<!-- Explicar sobre o modelo gravitacional. Revisão de outros usos como referência. Explicar uso prático. -->
<!-- O mais amplamente utilizado (TODO: Grosche) -->
<!-- Explicar os parâmetros que podem ser utilizados. -->
<!-- Dualidade da distância. -->

<!-- Procurar artigo de jorge-calderón. -->

Os modelos gravitacionais foram os modelos causais pioneiros para a previsão do volume de passageiros [@Grosche2007]. Sua utilizados para explicar como o tráfego se distribui nos pares-cidade, indicando o comportamento dos viajantes.

De acordo com @Grosche2007, a hipótese fundamental dos modelos gravitacionais é a de que ele pode ser construído a partir de variáveis econômicas ou sociais. Não obstante, essas variáveis podem ser de natureza geoeconômica, como população e distribuição de renda, ou relacionadas ao serviço de transporte aéreo em si, como preço de passagens, ou conveniências disponíveis no aeroporto.

A equação clássica do modelo gravitacional é dada, para um par-cidade, por:

$$T_{ij} = k V_i^\mu W_j^\alpha d_{ij}^{-\beta} $$

onde:

* $T_{ij}$ é o fluxo entre a origem e o destino;
* $V_i$ é a "emissibilidade" da origem;
* $W_j$ é a "atratividade" do destino;
* $d_{ij}$ é a resistência ao fluxo - como a distância;
* k é a constante de proporcionalidade;
* $\mu$, $\alpha$ e $\beta$ são os parâmetros do modelo.

A utilização do modelo gravitacional para a modelagem do volume de passageiros no transporte aéreo é vasta na literatura. @Nommik2016 desenvolveram um modelo gravitacional para a modelagem do volume de passageiros em rotas reginais, aplicado ao Aeroporto de Tallinn (EETN). Na pesquisa, utilizaram variáveis relacionadas ao serviço na construção do modelo, e demonstraram que o modelo gravitacional pode ser uma ferramenta simples e efetiva para uma análise primária conduzida por planejadores de rota na linha aérea. @Grosche2007 propuseram modelos gravitacionais uitilizando variáveis geoeconômicas, visando a aplicabilidade do modelo em pares-cidade que atualmente não possuam rotas estabelecidas. Os dois modelos propostos apresentaram erro baixo e foram validados estatisticamente.

## Modelos de *machine learning*
Embora que menos utilizado que o modelo gravitacional para a modelagem de volume de passageiros, encontram-se na literatura aplicações de modelos de *machine learning* nesse contexto.

@pourebrahim2018 estudaram um modelo gravitacional e outro de rede neural para a predição de fluxo de passageiros. Ainda que o foco do estudo tenha sido a melhora das predições com a utilização de dados de redes sociais, a comparação entre os modelos foi apresentada. De acordo com os autores, em termos da Raiz do Erro Quadrático Médio (RMSE, do inglês *Root Mean Squared Error*), o modelo gravitacional apresentou resultados melhores, enquanto o modelo de rede neural apresentou um coeficiente de determinação ($R^2$) mais elevado.

@erjongmanee2018 comparam modelos de regressão linear múltipla e rede neural com o gravitacional para o volume de passageiros doméstico na Tailândia. Tanto os modelos de regressão linear múltipla como os de rede neural apresentaram erros baixos.

# Desenvolvimento dos modelos

## Consolidação dos dados

Talvez seja benéfico tratar da parte comum e de decisões que afetem os dois modelos em uma seção unificada. Exemplo: variáveis geoeconômicas utilizadas.

## Modelo gravitacional
<!-- Para o modelo gravitacional, escolheu-se a representação por variáveis que descrevam a atividade econômica e característica geográfica dos pares-cidade, e não variáveis relacioadas às características do serviço aéreo por isso. Isso foi feito a fim de possibilitar a geração de um modelo aplicável a pares-cidade os quais não existam rotas estabelecidas. (TODO: citar Grosche) -->

<!-- Explicar as análises feitas para o desenvolvimento do modelo. Escolha das variáveis, calibragem dos parâmetros. -->

Explicar as análises feitas para o desenvolvimento do modelo gravitacional. Aqui, tratar da construção do modelo em si, calibragem dos parâmetros, quantificação dos erros e validação da hipótese nula.

## Modelos de *machine learning*

Explicar as análises feitas para o desenvolvimento dos modelos de machine learning.

### Regressão linear

Inserir desenvolvimentos.

### Rede neural

Inserir desenvolvimentos.

```{r figuraExemplo, echo=FALSE , message=FALSE, fig.cap="Figura de amostra", out.width = "100%", fig.align="center",fig.pos = 'H'}

knitr::include_graphics("../figures/sample_figure_1.png")

```

# Conclusões

Conclusão dos resultados obtidos.

